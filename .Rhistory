### Data ----
delta <- matrix(rbind(
c(-0.2, rep(0, 7)),
c(-0.52, -0.12, rep(0, 6)),
c(-1, -0.4, -0.4, -0.5, rep(0, 4)),
c(-1, -1, -1, -0.25, -1, -0.25, -0.25, 0)
), ncol = 8)
delta
### Graph ----
library(DiagrammeR)
df <- delta
# Graph object
grph <- create_graph()
# Adding nodes
for (i in 1:nrow(df)) {
for (j in 1:(2^(i-1))) {
grph <- grph %>% add_node(label = paste0(i, ", ", j))
}
}
# Adding edges
for (i in 1:(nrow(df) - 1)) {
children  <- paste0(i + 1, ", ", 1:(2^i))
for (j in 1:(2^(i-1))) {
grph <- grph %>% add_edge(from = paste0(i, ", ", j), to = children[1], edge_aes = list(label = "T"))
grph <- grph %>% add_edge(from = paste0(i, ", ", j), to = children[2], edge_aes = list(label = "H"))
children <- children[3:length(children)]
}
}
# Changing labels to values
grph$nodes_df$label <- unlist(lapply(grph$nodes_df$label, function(x) {
(unlist(df[as.numeric(gsub(",.*", "", x)), as.numeric(gsub(".*,\\s*", "", x))]))
}))
render_graph(graph = grph, layout = "tree")
roxygen2::roxygenize()
